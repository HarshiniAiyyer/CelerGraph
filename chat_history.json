[{"id": 1764374678180, "title": "FastAPI Dependency Injection Mechanism", "date": "Today", "conversation": [{"id": 1764374672753, "role": "user", "content": "How does FastAPI handle dependency injections?"}, {"id": 1764374672885, "role": "assistant", "content": "FastAPI injects dependencies by letting you declare them with the **`Depends`** (or **`Security`**) marker.\u202fYou pass a single callable\u2014usually a function\u2014that FastAPI will invoke automatically for each request instead of calling it yourself.\u202fWhen a path operation includes a parameter annotated with `Depends`, FastAPI resolves the callable, runs it **around the request\u2011response cycle**, and supplies its return value to the endpoint function.\u202fInternally FastAPI stores an `AsyncExitStack` in the request scope (named `fastapi_inner_astack` and `fastapi_function_astack`) so that any resources created by a dependency can be cleaned up after the response is sent\u202f[chunk:dependencies\\utils.py::34].\u202fThe dependency\u2011resolution logic also handles special type annotations (e.g., `Request`, `Response`, `SecurityScopes`) and ensures that `Depends` isn\u2019t mistakenly combined with those types\u202f[chunk:dependencies\\utils.py::23].\u202fThus, by declaring a dependency with `Depends` (or `Security` for OAuth2\u2011related cases), FastAPI automatically calls the function, manages its lifecycle, caches results when appropriate, and injects the result into the endpoint\u202f[node:param_functions.Depends::doc]\u202f[node:param_functions.Security::doc].\n\n**References:**  \n[node:param_functions.Depends::doc]  \n[node:param_functions.Security::doc]  \n[chunk:dependencies\\utils.py::34]  \n[chunk:dependencies\\utils.py::23]", "hasGraph": true, "graphNodes": []}]}]